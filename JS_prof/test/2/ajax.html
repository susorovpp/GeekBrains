<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div id="ajax-block"></div>
<button id="getData">Async get data</button>
<script>
    // let userJson = '{"name": "Anna", "age": 25, "isAdmin": true}';
    // console.log(userJson);
    // let user = JSON.parse(userJson);
    // console.log(user);
    // user.dateCreate = '2018-11-22';
    // user.address = {
    //     city: 'Saint Petersburg',
    //     postalCode: '999999'
    // };
    // console.log(user);
    // // let jsonUser = JSON.stringify(user, ['name', 'address', 'city', 'postalCode'], 4);
    // let jsonUser = JSON.stringify(user);
    // console.log(jsonUser);
    //
    // let a = JSON.parse(jsonUser, (key, value) => {
    //    console.log(key, value);
    //    if (key === 'dateCreate'){
    //        value = new Date(value);
    //    }
    //    return value;
    // });



    window.onload = () => {
        document.getElementById('getData').addEventListener('click', () => {

            //ES5

           // let xhr = new XMLHttpRequest();
           // xhr.open('GET', 'tel.json', true); //true - async
           //
           //  xhr.onreadystatechange = () => {
           //      console.log(xhr.readyState);
           //      //0 - запрос не инициалирован
           //      //1 - загрузка данных на сервер
           //      //2 - запрос получен сервиром
           //      //3 - идет обмен данными
           //      //4 - запрос выполнен
           //
           //      if(xhr.readyState !== 4){
           //          return
           //      }
           //
           //      if(xhr.status !== 200){
           //          console.log('Ошибка при получении данных', xhr.status, xhr.statusText)
           //      } else {
           //          console.log('ok', xhr.responseText);
           //          let data = JSON.parse(xhr.responseText);
           //          let dataBlock = document.getElementById('ajax-block');
           //          dataBlock.innerText = `Телефон ${data.tel} (${data.title})`;
           //      }
           //  };
           //  xhr.send();

            //ES6
            let dataBlock = document.getElementById('ajax-block');
            fetch('tel.json')
                .then(result => {
                    console.log(result);
                    return result.json()
                })
                .then(data => {
                    console.log(data);
                    dataBlock.innerText = `Телефон ${data.tel} (${data.title})`;
                })
                // .catch()

        });
    }

</script>
</body>
</html>